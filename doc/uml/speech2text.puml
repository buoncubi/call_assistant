@startuml
class digital.boline.callAssistant.speech2text.DesktopMicrophone {
- Int MIC_SAMPLE_SIZE_IN_BIT
- Int MIC_AUDIO_CHANNEL
- Float MIC_SAMPLE_RATE
+ InputStream? build()
}


interface digital.boline.callAssistant.speech2text.Speech2TextStreamBuilder {
+ InputStream? build()
}

class digital.boline.callAssistant.speech2text.Transcription$Companion {
+  UNKNOWN_TIME
+  UNKNOWN_CONFIDENCE
+  UNKNOWN_MESSAGE
}

class digital.boline.callAssistant.speech2text.Transcription {
-  messageBuilder
+ String message
+ Double confidence
+ Long startTime
+ Long endTime
+ String sourceTag
+ <<Create>> Transcription(String,Double,Long,Long,String)
+ void merge(Transcription)
+ void reset()
+ Boolean equals(Any?)
+ Int hashCode()
+ String toString()
}


abstract class digital.boline.callAssistant.speech2text.Speech2Text {
+  onResultCallbacks
+  onStartTranscribingCallbacks
+ <<Create>> Speech2Text(Speech2TextStreamBuilder)
+ void computeAsync(FrequentTimeout?,String)
}


class digital.boline.callAssistant.speech2text.AwsTranscribe$Companion {
-  LANGUAGE_CODE
-  AUDIO_STREAM_CHUNK_SIZE_IN_BYTES
-  SAMPLE_RATE
-  MEDIA_ENCODING
-  MINIMUM_WORDS_FOR_PARTIAL_RESULT
-  TRANSCRIPTION_BUFFERING_TIME
}

class digital.boline.callAssistant.speech2text.AwsTranscribe {
- TranscribeStreamingAsyncClient? client
- StartStreamTranscriptionRequest? request
- CompletableFuture<Void>? transcribeJob
-  bufferingTranscription
- Job? mergingJob
- Long? audioStreamStartTime
-  userStartedSpeaking
-  userIsSpeaking
+ String sourceTag
+ <<Create>> AwsTranscribe(Speech2TextStreamBuilder)
- TranscribeStreamingAsyncClient initClient()
- StartStreamTranscriptionRequest initRequest()
+ void doActivate(String)
+ void doComputeAsync(Unit,String)
- void getResponseHandler()
- List<Transcription> parseTranscriptions(List<Result>)
- void handleTranscriptions(List<Result>)
+ void doStop(String)
+ void doDeactivate(String)
}


class digital.boline.callAssistant.speech2text.AudioStreamPublisher$Companion {
- SubscriptionImpl? currentSubscription
-  mutex
+ void stop()
}


class digital.boline.callAssistant.speech2text.AudioStreamPublisher {
+ <<Create>> AudioStreamPublisher(InputStream,CentralizedLogger)
+ void subscribe(Subscriber<in AudioStream?>)
}

class digital.boline.callAssistant.speech2text.SubscriptionImpl {
- ExecutorService executor
-  demand
-  isOpen
- <<Create>> SubscriptionImpl(Subscriber<in AudioStream?>,InputStream,CentralizedLogger)
- ByteBuffer getNextEvent()
+ void request(Long)
+ void cancel()
+ void stop()
}




digital.boline.callAssistant.speech2text.Speech2TextStreamBuilder <|.. digital.boline.callAssistant.speech2text.DesktopMicrophone
digital.boline.callAssistant.Loggable <|-- digital.boline.callAssistant.speech2text.DesktopMicrophone
digital.boline.callAssistant.speech2text.Transcription +.. digital.boline.callAssistant.speech2text.Transcription$Companion
digital.boline.callAssistant.speech2text.CallbackInput <|.. digital.boline.callAssistant.speech2text.Transcription
digital.boline.callAssistant.speech2text.ReusableService <|-- digital.boline.callAssistant.speech2text.Speech2Text
digital.boline.callAssistant.speech2text.AwsTranscribe +.. digital.boline.callAssistant.speech2text.AwsTranscribe$Companion
digital.boline.callAssistant.speech2text.Speech2Text <|-- digital.boline.callAssistant.speech2text.AwsTranscribe
digital.boline.callAssistant.speech2text.AudioStreamPublisher +.. digital.boline.callAssistant.speech2text.AudioStreamPublisher$Companion
org.reactivestreams.Publisher <|.. digital.boline.callAssistant.speech2text.AudioStreamPublisher
org.reactivestreams.Subscription <|.. digital.boline.callAssistant.speech2text.SubscriptionImpl
@enduml